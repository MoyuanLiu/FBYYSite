{% extends "base.html" %}
{% block content %}
<div class="jumbotron text-center" style="margin-bottom:0">
  <h1>修改开车款信息</h1>
</div>
<div class="container" style="margin-top:100px; width:40em;">
 <form action="kckeditcheck" method="post">
    <!-- {% csrf_token %} -->
     <div class="form-group">
      <input type="hidden" name="kckid"  value="{{kck.idtb_kck}}">
    </div>
     <div class="form-group">
      <input type="hidden" name="refererurl"  value="{{refererurl}}">
    </div>
    <div class="form-group">
        {{ form.kckproductid.errors }}
      <label for="id_kckproductid">宝贝ID:</label>
      <input type="text" name="kckproductid" placeholder="请输入宝贝ID" class="form-control" maxlength="20" required="" id="id_kckproductid" value="{{kck.tb_kck_product_id}}">
    </div>
    <div class="form-group">
        {{ form.kckproductcolornum.errors }}
      <label for="id_kckproductcolornum">货号(到色):</label>
      <input type="text" name="kckproductcolornum" placeholder="请输入货号(到色)" class="form-control" maxlength="20" required="" id="id_kckproductcolornum" value="{{kck.tb_kck_product_color_num}}">
    </div>
    <div class="form-group">
        {{ form.kckproductcategory.errors }}
      <label for="id_kckproductcategory">类目:</label>
      <input type="" name="kckproductcategory" placeholder="请输入类目" class="form-control" maxlength="20" required="" id="id_kckproductcategory" value="{{kck.tb_kck_product_category}}">
    </div>
    <div class="form-group">
        {{ form.kckshelfdate.errors }}
      <label for="id_kckshelfdate">上架日期:</label>
       <input type="text" name="kckshelfdate" placeholder="上架日期:yyyy-mm-dd" class="form-control" required="" id="id_kckshelfdate" value="{{kck.tb_kck_product_shelf_date}}">
    </div>
    <div class="form-group">
        {{ form.kckseldepart.errors }}
      <label for="kckseldepart">部门:</label>
      <select class="form-control" id="kckseldepart" name="kckseldepart">
        {% for department in departments %}
          {% ifequal department.tb_department_info_code kck.tb_kck_depart_code %}
            <option value={{ department.tb_department_info_code }} selected="selected">{{ department.tb_department_info_name }}</option>
          {% else %}
            <option value={{ department.tb_department_info_code }}>{{ department.tb_department_info_name }}</option>
          {% endifequal %}
        {% endfor %}
      </select>
    </div>
    <div class="form-group">
        {{ form.kckselstore.errors }}
      <label for="kckselstore">所在店铺:</label>
      <select class="form-control" id="kckselstore" name="kckselstore">
      </select>
    </div>
    <input type="submit" class="btn btn-primary" value="确认修改">
    <a href="{{refererurl}}" class="btn btn-secondary" role="button">取消修改</a>
  </form>
    <script>
  $(".errorlist").addClass("list-group")
  $(".errorlist li").addClass("list-group-item-danger")

  var depart_code = $("#kckseldepart").val();
if(depart_code===''){
$('#kckselstore').empty();
}else{
      $.ajax({
        url: '/fbyysite/reportmanage/kck/ajaxstores',
        data: {
          'depart_code': depart_code
        },
        type: 'GET',
        dataType: 'json',
        success: function (data) {
                  $('#kckselstore').empty();
            var content='';
            $.each($.parseJSON(data), function(i, item){
                  content+='<option value='+item.fields.tb_store_code+'>'+item.fields.tb_store_code+'</option>'
                });
            $('#kckselstore').html(content)
        },
      });
}
$("#kckseldepart").change(function() {
      var depart_code = $(this).val();
        if(depart_code===''){
            $('#kckselstore').empty();
        }else{
        $.ajax({
        url: '/fbyysite/reportmanage/kck/ajaxstores',
        data: {
          'depart_code': depart_code
        },
        type: 'GET',
        dataType: 'json',
        success: function (data) {
                  $('#kckselstore').empty();
            var content='';
            $.each($.parseJSON(data), function(i, item){
                  content+='<option value='+item.fields.tb_store_code+'>'+item.fields.tb_store_code+'</option>'
                });
            $('#kckselstore').html(content)
        },
      });
        }  
    });

</script>
</div>
{% endblock %}